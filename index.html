<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nepal Nightlights Dashboard</title>

    <!-- External Libraries -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="/assets/styles/main.css">
</head>
<body>
    <!-- Header Section -->
    <div class="header">
        <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 16px;">
            <div>
                <h1>Nepal Night Lights Analysis</h1>
                <div class="header-subtitle">Energy Access & Economic Development (1992-2024)</div>
            </div>
        </div>
    </div>

    <!-- Main Content Container -->
    <div class="container">
        <!-- Main Visualization Card -->
        <div class="main-card">
            <div class="split-view">
                <!-- Map Section -->
                <div class="map-section">
                    <div class="section-label">
                        Spatial Distribution
                        <span class="info-icon" title="1km resolution composite, showing radiance intensity">ⓘ</span>
                    </div>
                    <div style="position: relative;">
                        <img id="mapImage" src="" alt="Nepal Nightlights" style="display:none; width: 100%; height: auto;">
                        <div id="mapPlaceholder" style="background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
                            height: 400px; border-radius: 10px; display: flex; align-items: center; justify-content: center;
                            color: #374151; font-weight: 600;">
                            Spatial visualization loading...
                        </div>
                        <div id="yearOverlay" style="position: absolute; top: 13%; right: 13%;
                            background: transparent; padding: 4px 10px; border-radius: 6px;
                            font-size: 1.5em; font-weight: 800; color: #ffffff; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
                            1992
                        </div>
                    </div>

                    <!-- Animation Controls -->
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
                        <div style="display: flex; flex-wrap: wrap; gap: 12px; align-items: center; justify-content: center;">
                            <button id="playBtn" onclick="togglePlay()">▶ Play Animation</button>
                            <button onclick="previousFrame()">← Previous</button>
                            <button onclick="nextFrame()">Next →</button>
                            <button onclick="resetAnimation()">↻ Reset</button>
                            <input type="range" id="frameSlider" min="0" max="0" value="0" oninput="seekFrame(this.value)" style="width: 200px;">
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <span style="font-weight:600; font-size: 0.85em;">Speed:</span>
                                <button onclick="setSpeed(2000)" style="padding: 6px 12px; font-size: 0.8em;">Slow</button>
                                <button onclick="setSpeed(1000)" style="padding: 6px 12px; font-size: 0.8em;">Normal</button>
                                <button onclick="setSpeed(500)" style="padding: 6px 12px; font-size: 0.8em;">Fast</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chart Section -->
                <div class="chart-section">
                    <div class="section-label">
                        Temporal Evolution
                        <span class="info-icon" title="Shaded area shows ±15-20% uncertainty for DMSP, ±10% for VIIRS">ⓘ</span>
                    </div>
                    <div id="timeSeriesChart"></div>
                </div>
            </div>
        </div>

        <!-- Methodology Card -->
        <div class="methodology-card">
            <div class="card-title">Methodology & Data Provenance</div>
            <div class="methodology-grid">
                <div class="method-item">
                    <div class="method-label">Data Sources</div>
                    <div class="method-value">DMSP-OLS (1992-2013), VIIRS-DNB (2014-2023)</div>
                </div>
                <div class="method-item">
                    <div class="method-label">Harmonization</div>
                    <div class="method-value">Li et al. (2020) intercalibration methodology</div>
                </div>
                <div class="method-item">
                    <div class="method-label">Spatial Resolution</div>
                    <div class="method-value">1km nominal, resampled to common grid</div>
                </div>
                <div class="method-item">
                    <div class="method-label">Temporal Resolution</div>
                    <div class="method-value">Annual composites (cloud-free, stable lights)</div>
                </div>
            </div>
        </div>

        <!-- Climate & SDG Goals Card -->
        <div class="methodology-card">
            <div class="card-title">Connection to Climate & SDG Goals</div>
            <div class="methodology-grid">
                <div class="method-item" style="border-left-color: #10b981;">
                    <div class="method-label">SDG 7: Affordable & Clean Energy</div>
                    <div class="method-value">Universal electricity access target by 2030. Nepal reached ~93% household electrification by 2023.</div>
                </div>
                <div class="method-item" style="border-left-color: #8b5cf6;">
                    <div class="method-label">NDC Commitment (2021 Update)</div>
                    <div class="method-value">Net-zero emissions by 2045, 15 GW installed capacity by 2030 (primarily hydropower).</div>
                </div>
                <div class="method-item" style="border-left-color: #f59e0b;">
                    <div class="method-label">Climate Vulnerability</div>
                    <div class="method-value">Hydropower-dependent grid faces risks from glacial melt, precipitation variability, and extreme weather events.</div>
                </div>
                <div class="method-item" style="border-left-color: #3b82f6;">
                    <div class="method-label">Energy Transition Pathway</div>
                    <div class="method-value">Shift from diesel/kerosene to grid electricity reduces emissions but requires climate-resilient infrastructure.</div>
                </div>
            </div>
        </div>

        <!-- References Alert -->
        <div class="alert" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-left-color: #3b82f6;">
            <div class="alert-title" style="color: #0f1010;">References & Further Reading</div>
            <div class="alert-content" style="color: #050505; line-height: 1.8;">
                • Li et al. (2020). "Harmonizing DMSP and VIIRS nighttime light data" <em>Remote Sensing of Environment</em><br>
                • Nepal Electricity Authority (NEA) Annual Reports (2015-2023)<br>
                • World Bank: Electricity Access Indicators for Nepal<br>
                • Nepal NDC (2021 Update): Nationally Determined Contribution to UNFCCC<br>
                • Census of Nepal (2021): Household Electrification Statistics
            </div>
        </div>
    </div>

    <!-- Custom Scripts -->
    <script src="/assets/scripts/main.js"></script>
</body>
</html>
